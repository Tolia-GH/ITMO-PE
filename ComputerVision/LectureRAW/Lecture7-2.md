## [MainPage](../../index.md)/[Computer Vision](../README.md)/[Lecture](../Lecture.md)/7-2 RAW

语音识别：Youtube 转文本  
断句与标点：chatGPT 4o  
翻译：chatGPT 4o  

Утром еще один оператор поиска контурных особенностей изображений — оператор Айверсона (по фамилии одного из создателей) — был опубликован в 1995 году. Он был призван улучшить действия существующих линейных операторов для распознавания границ путем добавления логических проверок на существование границы. Это позволило уменьшить число ошибочно распознанных линий без потери чувствительности. Основным преимуществом данного алгоритма является значительное уменьшение количества ошибочно положительных откликов, то есть распознавания несуществующих границ, по сравнению с ранее разработанными алгоритмами. Кроме того, оператор Айверсона позволяет четко разделять между собой три вида границ: края, светлые линии и темные линии. Светлые и темные линии отличаются либо приростом контраста, либо убыванием. В основе данного алгоритма лежит семейство так называемых логических линейных операторов, которые объединяют в себе теорию линейных операторов и алгебру логики. Условия проверки, содержащиеся в данных операторах, делятся на два различных класса: нормальные условия, или условия перпендикуляров, то есть условия, призванные распознать категорию и найденную границу, и тангенциальные условия, или условия касательных, то есть условия, гарантирующие непрерывность найденной границы.

Общий вид двумерного логического линейного оператора представлен на слайде. Здесь x и y являются координатами в локальной ортонормированной системе координат изображения, то есть стандартными координатами на нашем прямоугольном изображении. Оператор ψ является декартовым произведением двух одномерных логических линейных операторов. Оператор T, или тангенциальный оператор, выполняет проверку на непрерывность рассматриваемой границы, а оператор N — это нормальный оператор, он выполняет проверку на существование границы, где индекс задает просматриваемую границу: P для светлых линий, N для темных, E для краев светлых или темных областей. Оператор T является идентичным для всех типов границ. Нормальный оператор для светлых линий имеет вид, представленный на слайде. Также можно ознакомиться с операторами темных линий и нормальными операторами краев. Также на слайде представлен вид тангенциального оператора. Линейными составляющими представленных логических линейных нормальных операторов являются выражения, использующие производные Гаусса, и с помощью операций свертки линейных составляющих операторов функций входного сигнала с изображением. Алгоритм Айверсона позволяет проверять локальные условия существования границ на определенном участке изображения.

Рассмотрим еще один примечательный метод поиска контурных особенностей на изображении — оператор Канни. Он же детектор границ Канни или алгоритм Канни представляет собой оператор обнаружения границ изображения, был разработан Джоном Канни, как нетрудно догадаться, и использует многоступенчатый алгоритм для обнаружения широкого спектра границ на изображениях. Канни изучил математическую проблему получения фильтра, оптимального по критериям выделения, локализации и минимизации нескольких откликов одной границы. Он показал, что искомый фильтр является суммой четырех экспонент. Он также показал, что этот фильтр может быть хорошо приближен первой производной Гаусса. Более того, Канни ввел понятие подавления максимумов. Данная идея широко используется в современных методах искусственного интеллекта, но в работе Канни данная идея используется в том контексте, когда пикселями границ объявляются пикселы, в которых достигается локальный максимум градиента в направлении вектора градиента. Хотя работа Канни была проведена на заре компьютерного зрения, детектор границ Канни до сих пор является одним из лучших детекторов. Кроме особенных частных случаев, трудно найти детектор границ, который работал бы существенно лучше, чем детектор Канни. Целью Канни было разработать оптимальный алгоритм обнаружения границ, удовлетворяющий трем критериям. Во-первых, это хорошее обнаружение: Канни трактовал это свойство как повышение отношения сигнала к шуму. Во-вторых, это хорошая локализация, то есть правильное определение положения границы. В-третьих, алгоритм должен был обеспечивать единственный отклик на одну границу. Из всех этих критериев затем строилась целевая функция стоимости ошибок, минимизация которой находится оптимальный линейный оператор для свертки с изображением. Алгоритм детектора границ Канни не ограничивается вычислением градиента сглаженного изображения. В контуре границы оставляются только точки максимума градиента изображения. Не максимальные точки, лежащие рядом с границей, удаляются. Здесь также используется информация о направлении границы для того, чтобы удалять точки именно рядом с границей и не разрывать саму границу вблизи локальных максимумов градиента. Затем с помощью двух порогов удаляются слабые границы. Фрагмент границы при этом обрабатывается как целое: если значение градиента где-нибудь на прослеживаемом фрагменте превысит верхний порог, то этот фрагмент остается. Также допустимые границы и в тех местах, где значение градиента падает ниже этого порога, до тех пор пока оно не станет ниже нижнего порога. Если же на всем фрагменте нет ни одной точки со значением больше верхнего порога, то он удаляется. Такой гистерезис позволяет снизить число разрывов в выходных границах. Включение в алгоритм Канни шумоподавления с одной стороны повышает устойчивость результатов к наличию шума, а с другой стороны увеличивает вычислительные затраты и приводит к искажению и даже потере подробностей границ. Но это неизбежная плата: так, например, таким алгоритмом скругляются углы объектов и разрушаются границы в точках соединения.

Итак, рассмотрим подробнее основные шаги алгоритма Канни. На первой стадии производится сглаживание, то есть размытие изображения для удаления шума. Оператор Канни использует фильтр, который может быть хорошо приближен к первой производной Гаусса. Пример ядра данного фильтра изображен на слайде. На второй стадии осуществляется поиск градиентов. Границы отмечаются там, где градиент изображения приобретает максимальное значение. Они могут иметь различные направления, поэтому алгоритм Канни использует четыре фильтра для обнаружения горизонтальных, вертикальных и диагональных ребер в размытом изображении. Угол направления вектора градиента округляется и может принимать значения 0°, 45°, 90°, 135°. На стадии подавления немаксимумов только локальные максимумы отмечаются как границы. Далее осуществляется двойная пороговая фильтрация: потенциальные границы определяются порогами. Далее производится трассировка областей неоднозначности. Итоговые границы определяются путем подавления всех краев, не связанных с определенными сильными границами. Перед применением детектора обычно преобразуют изображение в монохромное представление, чтобы уменьшить вычислительные затраты. Этот этап характерен для многих методов обработки изображений и в частности для методов выделения границ. Заметим, что рассмотренные механизмы получения контурных признаков на выходе представляют нам карты, размер которых примерно совпадает с разрешением исходного изображения. Однако для получения сжатого векторизованного представления характеризующих признаков, которые удобно передавать стандартные движки классификации и кластеризации, pipeline которых можно увидеть на слайде, удобно использовать гистограммы и другие статистические сжатые представления, посчитанные поверх распределения низкоуровневых контурных признаков.

На одной из предыдущих лекций мы рассматривали алгоритм построения дескриптора изображений на основе гистограммы, вычисляющей статистическую оценку ориентации градиента, то есть мы рассматривали HOG-дескриптор. Помимо гистограмм могут быть использованы хэш-функции, к примеру, которые могут быть основаны либо на вычислениях и сборе статистики по каким-то низкоуровневым примитивам, например, контурам, или же особенным точкам, находящимся в определенных регионах изображения. Такие подходы мы рассмотрим далее. Так, и так могут быть основаны на прямом вычислении хэш-значений из сырого или же чуть трансформированного представления исходного изображения. Такие подходы мы также рассмотрим на наших лекциях далее. Нельзя также не отметить еще один вид низкоуровневых признаков. Помимо контуров, часто хорошими характеристическими особенностями изображений являются особые точки, к примеру, уголки. Мы рассматривали алгоритмы поиска углов на изображениях в контексте создания системы трекинга объектов на основании ключевых точек. Поэтому здесь мы рассмотрим лишь возможное применение данных низкоуровневых особенностей в контексте получения глобального дескриптора изображения в виде некоторой хэш-функции. Суть подхода довольно проста: мы разбиваем