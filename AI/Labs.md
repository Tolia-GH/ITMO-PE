## [MainPage](../index.md)/[AI System](README.md)/Labs <!-- omit from toc -->

# AI System <!-- omit from toc -->

Курс состоит из двух блоков:

- Базы знаний и онтологии
- Классические методы МО

Каждый блок включает в себя несколько лабораторных работ, для сдачи необходимо сделать R&D отчет по итогам модуля. Защита лабораторных работ происходит в таком формате:

- Показываете ЛР в виде рабочего проекта - если всё ок, значит можно приступать к следующему заданию. Показывать две за раз можно, но если есть замечания, то на следующей паре можно только показывать ЛР, а не защищать модуль.
- Для закрытия модуля и получения оценки необходимо рассказать про блок выполненных заданий с точки зрении постановки задачи, требований, ограничений, назначения.

[Модуль 1. Базы знаний и онтологии](#модуль-1-базы-знаний-и-онтологии)
- [Лабораторная 1. Создание базы знаний и выполнение запросов в Prolog](#лабораторная-1-создание-базы-знаний-и-выполнение-запросов-в-prolog)
- [Лабораторная 2. Создание онтологии в Protege](#лабораторная-2-создание-онтологии-в-protege)
- [Лабораторная 3. Разработка системы поддержки принятия решения на основе базы знаний или онтологии](#лабораторная-3-разработка-системы-поддержки-принятия-решения-на-основе-базы-знаний-или-онтологии)
  
[Модуль 2. Методы МО](#модуль-2-методы-мо)
- [Лабораторная 4. Линейная регрессия](#лабораторная-4-линейная-регрессия)
- [Лабораторная 5. Метод k-ближайших соседей](#лабораторная-5-метод-k-ближайших-соседей)
- [Лабораторная 6. Деревья решений](#лабораторная-6-деревья-решений)
- [Лабораторная 7.  Логистическая регрессия](#лабораторная-7--логистическая-регрессия)

## Модуль 1. Базы знаний и онтологии <!-- omit from toc -->

### Лабораторная 1. Создание базы знаний и выполнение запросов в Prolog

Требуется создать базу знаний в языке программирования Prolog и реализовать набор запросов, используя эту базу знаний. Задача направлена на развитие навыков работы с фактами, предикатами, и правилами в логическом программировании.  
需要用 Prolog 编程语言创建一个知识库，并使用该知识库实现一组查询。 该任务旨在培养逻辑编程中处理事实、谓词和规则的技能。

**Задание**

- **Создание базы знаний:**
    
  Создайте базу знаний. База знаний должна включать в себя **не менее 20 фактов с одним аргументом, 10-15 фактов с двумя аргументам, которые дополняют и показывают связь с другими фактами и 5-7 правил.** Факты могут описывать объекты, их свойства и отношения между ними. Предикаты могут описывать различные атрибуты объектов, а правила - логические законы и выводы, которые можно сделать на основе фактов и предикатов.  
  创建知识库。 知识库应包括**至少 20 个带有一个论点的事实、10-15 个带有两个论点的事实来补充并显示与其他事实的联系以及 5-7 条规则。** 事实可以描述对象、它们的属性以及它们之间的关系。 谓词可以描述对象的各种属性，规则是根据事实和谓词可以得出的逻辑规律和结论。
    
- **Выполнение запросов:**
    
  Напишите несколько запросов для БЗ. Запросы **должны быть разной сложности** и включать в себя:  
  为知识库编写几个查询。 请求**必须具有不同的复杂性**，并包括：
    
  - Простые запросы к базе знаний для поиска фактов.
  - Запросы, использующие логические операторы (**и, или, не**) для формулирования сложных условий.
  - Запросы, использующие переменные для поиска объектов с определенными характеристиками.
  - Запросы, которые требуют выполнения правил для получения результата.  

  - 简单查询知识库以查找事实。
  - 使用逻辑运算符（**and、or、not**）来制定复杂条件的查询。
  - 使用变量来查找具有某些特征的对象的查询。
  - 需要遵循规则才能获得结果的查询。
- **Документация: 文档：**
    
  В коде должны быть комментарии описания фактов, предикатов и правил.  
  代码应包含描述事实、谓词和规则的注释。
    

**Критерии оценки 评估标准**

- Корректность базы знаний и выполненных запросов.
- Сложность и разнообразие запросов.
- Качество документации и комментариев к коду.  

- 知识库和执行查询的正确性。
- 请求的复杂性和多样性。
- 文档和代码注释的质量。

**Тематики БЗ BZ主题**

Любая, связанная с играми. Например,  
任何与游戏有关的东西。 例如，

- Видеоигры
- Правила настольных игр
- Профили игроков
- Игровые персонажи
- История игры
- Игровые механики

- 视频游戏
- 棋盘游戏规则
- 玩家档案
- 游戏角色
- 游戏历史
- 游戏机制

### Лабораторная 2. **Создание онтологии в Protege**

Целью этой лабораторной работы является знакомство со средой разработки онтологий Protege и перевод базы знаний, созданной в предыдущей лабораторной работе в онтологическую форму в Protege.

**Задание**

Преобразовать факты и отношения из Prolog в концепты и свойства в онтологии. Описать классы и свойства в онтологии, которые соответствуют объектам и отношениям из базы знаний. Например, если у были классы "Человек" и "Машина" и свойство "возраст", создайте аналогичные классы и свойства в онтологии в Protege.

**Критерии оценки**

- Корректное создание онтологии в Protege на основе базы знаний в Prolog.
- Качество перевода фактов, предикатов и отношений из Prolog в онтологию.
- Определение классов, свойств и иерархии классов в Protege.
- Тестирование онтологии и демонстрация ее функциональности (визуализация и проверка запросов).

### Лабораторная 3. Разработка системы поддержки принятия решения на основе базы знаний или онтологии

Целью этой лабораторной работы является разработка программы, которая будет использовать базу знаний или онтологию для предоставления рекомендаций на основе введенных пользователем данных. (Knowledge-based support system)

**Задание**

- Создать программу, которая позволяет пользователю ввести запрос через командную строку. Например, информацию о себе, своих интересах и предпочтениях в контексте выбора видеоигры - на основе фактов из БЗ (из первой лабы)/Онтологии(из второй).
- Использовать введенные пользователем данные, чтобы выполнить логические запросы к  БЗ/Онтологии.
- На основе полученных результатов выполнения запросов, система должна предоставить рекомендации или советы, связанные с выбором из БЗ или онтологии.

**Пример**

Входная строка:

Мне 13 лет, мне нравятся: RPG, инди-игры

**Нужно**

Спарсить строку, разбить на факты, построить запрос, используя эти предикаты. (Формат входной строки фиксированный, искать частичное соответсвие подстроки не нужно)

**Критерии оценки**

- Корректность и эффективность реализации системы поддержки принятия решения.
- Способность программы адекватно использовать базу знаний или онтологию для выдачи рекомендаций.
- Качество тестирования и обработка ввода пользователя.
- Качество документации и описание работы системы.

[Шаблон отчёта по Модулю 1](https://www.notion.so/1-ea9a418d514b4baa8f7b4fc4c3ee176e?pvs=21)

# Модуль 2. Методы МО <!-- omit from toc -->

В модуле 4 лабораторные работы. Реализовывать можно на любом языке. По каждой лабораторной необходимо сделать небольшой отчёт с результатами выполнения работы. По завершению модуля - большой отчёт. 

## Лабораторная 4. Линейная регрессия

[Линейная регрессия. Теоретическая часть (1)](https://www.notion.so/1-f2323e041d6a435191b76b0bc088f106?pvs=21)

**Задание**

- Выбор датасетов:
    - Студенты с **четным** порядковым номером в группе должны использовать набор данных о [жилье в Калифорнии](https://developers.google.com/machine-learning/crash-course/california-housing-data-description?hl=ru) Скачать [тут](https://download.mlcc.google.com/mledu-datasets/california_housing_train.csv)
    - Студенты с **нечетным** порядковым номером в группе должны использовать [про обучение студентов](https://www.kaggle.com/datasets/nikhil7280/student-performance-multiple-linear-regression)
- Получите и визуализируйте статистику по датасету (включая количество, среднее значение, стандартное отклонение, минимум, максимум и различные квантили).
- Проведите предварительную обработку данных, включая обработку отсутствующих значений, кодирование категориальных признаков и нормировка.
- Разделите данные на обучающий и тестовый наборы данных.
- Реализуйте линейную регрессию с использованием метода наименьших квадратов без использования сторонних библиотек, кроме NumPy и Pandas. Использовать минимизацию суммы квадратов разностей между фактическими и предсказанными значениями для нахождения оптимальных коэффициентов.
- Постройте **три модели** с различными наборами признаков.
- Для каждой модели проведите оценку производительности, используя метрику коэффициент детерминации, чтобы измерить, насколько хорошо модель соответствует данным.
- Сравните результаты трех моделей и сделайте выводы о том, какие признаки работают лучше всего для каждой модели.
- Бонусное задание
    - Ввести синтетический признак при построении модели

## Лабораторная 5. Метод k-ближайших соседей

**Задание**

Выбор датасета:

Четный номер в группе - Датасет [о вине](https://www.kaggle.com/datasets/davorbudimir/winedataset)

Нечетный номер в группе - Датасет [про обезьян](https://www.kaggle.com/datasets/slothkong/10-monkey-species)

- Проведите предварительную обработку данных, включая обработку отсутствующих значений, кодирование категориальных признаков и масштабирование.
- Реализуйте метод k-ближайших соседей ****без использования сторонних библиотек, кроме NumPy и Pandas.
- Постройте две модели k-NN с различными наборами признаков:
    - Модель 1: Признаки случайно отбираются .
    - Модель 2: Фиксированный набор признаков, который выбирается заранее.
- Для каждой модели проведите оценку на тестовом наборе данных при разных значениях k. Выберите несколько различных значений k, например, k=3, k=5, k=10, и т. д. Постройте матрицу ошибок.

## Лабораторная 6. Деревья решений

[Деревья решений. Теоретическая часть (1)](https://www.notion.so/1-4ac65285f2464ab6964367456fd0206a?pvs=21)

**Задание**

1. Для студентов с четным порядковым номером в группе – датасет с [классификацией грибов](https://archive.ics.uci.edu/ml/datasets/Mushroom), а нечетным – [датасет с данными про оценки студентов инженерного и педагогического факультетов](https://archive.ics.uci.edu/dataset/856/higher+education+students+performance+evaluation) (для данного датасета нужно ввести метрику: студент успешный/неуспешный на основании грейда)
2. Отобрать **случайным** образом sqrt(n) признаков
3. Реализовать без использования сторонних библиотек построение дерева решений (numpy и pandas использовать можно, использовать списки для реализации  дерева - нельзя)
4. Провести оценку реализованного алгоритма с использованием Accuracy, precision и recall
5. Построить AUC-ROC и AUC-PR (в пунктах 4 и 5 использовать библиотеки нельзя)

## Лабораторная 7.  Логистическая регрессия

[логистическая регрессия.docx](https://prod-files-secure.s3.us-west-2.amazonaws.com/d5c92538-65d6-4833-ae99-f27868eeaf39/55221bbd-8a47-42f7-878b-a1608bdf4120/%D0%BB%D0%BE%D0%B3%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D1%80%D0%B5%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D1%8F.docx)

1. Выбор датасета:
- Датасет о пассажирах Титаника: [Titanic Dataset](https://www.kaggle.com/c/titanic)
- Датасет о диабете: [Diabetes Dataset](https://www.kaggle.com/uciml/pima-indians-diabetes-database)
- Загрузите выбранный датасет и выполните предварительную обработку данных.
- Разделите данные на обучающий и тестовый наборы в соотношении, которое вы считаете подходящим.
- Реализуйте логистическую регрессию "с нуля" без использования сторонних библиотек, кроме NumPy и Pandas. Ваша реализация логистической регрессии должна включать в себя:
    - Функцию для вычисления гипотезы (sigmoid function).
    - Функцию для вычисления функции потерь (log loss).
    - Метод обучения, который включает в себя градиентный спуск.
    - Возможность варьировать гиперпараметры, такие как коэффициент обучения (learning rate) и количество итераций.
1. Исследование гиперпараметров:
    - Проведите исследование влияния гиперпараметров на производительность модели. Варьируйте следующие гиперпараметры:
        - Коэффициент обучения (learning rate).
        - Количество итераций обучения.
        - Метод оптимизации (например, градиентный спуск или оптимизация Ньютона).
2. Оценка модели:
    - Для каждой комбинации гиперпараметров оцените производительность модели на тестовом наборе данных, используя метрики, такие как accuracy, precision, recall и F1-Score.

Сделайте выводы о том, какие значения гиперпараметров наилучшим образом работают для данного набора данных и задачи классификации. Обратите внимание на изменение производительности модели при варьировании гиперпараметров.